<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企业定额自动套用工具</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>企业定额自动套用工具</h1>
        </header>

        <div class="action-panel">
            <div class="upload-section">
                <h2>数据导入</h2>
                <div class="upload-group">
                    <label for="quotaFile">导入企业定额数据（Excel）</label>
                    <input type="file" id="quotaFile" accept=".xlsx,.xls">
                    <button onclick="importQuotas()">导入定额</button>
                    <span id="quotaStatus"></span>
                </div>
                <div class="upload-group">
                    <label for="itemFile">导入项目清单数据（Excel）</label>
                    <input type="file" id="itemFile" accept=".xlsx,.xls">
                    <button onclick="importItems()">导入清单</button>
                    <span id="itemStatus"></span>
                </div>
            </div>

            <div class="match-section">
                <h2>定额匹配</h2>
                <button onclick="matchQuotas()" class="btn-primary">开始批量匹配</button>
                <span id="matchStatus"></span>
            </div>

            <div class="export-section">
                <h2>数据导出</h2>
                <button onclick="exportData()" class="btn-success">导出匹配结果</button>
                <button onclick="clearAll()" class="btn-danger">清空所有数据</button>
            </div>
        </div>

        <div class="data-panel">
            <h2>项目清单列表</h2>
            <div class="toolbar">
                <input type="text" id="searchInput" placeholder="搜索清单名称或特征值..." onkeyup="filterItems()">
                <button onclick="loadItems()">刷新列表</button>
            </div>
            <div class="table-container">
                <table id="itemsTable">
                    <thead>
                        <tr>
                            <th>清单编码</th>
                            <th>清单名称</th>
                            <th>项目特征值</th>
                            <th>单位</th>
                            <th>工程量</th>
                            <th>匹配定额编码</th>
                            <th>匹配定额名称</th>
                            <th>定额项目特征</th>
                            <th>单价</th>
                            <th>合价</th>
                            <th>匹配状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody">
                        <tr>
                            <td colspan="12" class="empty-message">暂无数据，请先导入项目清单</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h2>编辑匹配定额</h2>
            <div class="modal-body">
                <div class="form-group">
                    <label>当前清单：</label>
                    <span id="currentItemName"></span>
                </div>
                <div class="form-group">
                    <label>搜索企业定额：</label>
                    <input type="text" id="quotaSearchInput" placeholder="输入定额名称或特征值搜索..." onkeyup="searchQuotas()">
                    <button onclick="searchQuotas()">搜索</button>
                </div>
                <div class="quota-list" id="quotaList">
                    <p>请输入关键词搜索企业定额</p>
                </div>
                <div class="form-group">
                    <label>或直接输入单价：</label>
                    <input type="number" id="manualPrice" step="0.01" placeholder="输入单价">
                    <button onclick="updatePrice()">更新单价</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

